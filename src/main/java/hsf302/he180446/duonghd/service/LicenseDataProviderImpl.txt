package com.example.demo.service;

import com.example.demo.repository.LicenseRepository;
import hsf302.he180446.duonghd.config.LicenseDataProvider;
import hsf302.he180446.duonghd.pojo.License;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class LicenseDataProviderImpl implements LicenseDataProvider {

    private final LicenseRepository repo;

    @Autowired
    public LicenseDataProviderImpl(LicenseRepository repo) {
        this.repo = repo;
    }

    @Override
    public Optional<License> findByLicenseKey(String key) {
        return repo.findByLicenseKey(key).map(appLicense -> {
            // Chuyển entity app chính sang entity của lib
            License libLicense = new License();
            libLicense.setLicenseKey(appLicense.getLicenseKey());
            libLicense.setProduct(appLicense.getProduct());
            libLicense.setExpiryDate(appLicense.getExpiryDate());
            libLicense.setStatus(appLicense.getStatus());
            // thêm các field khác nếu có
            return libLicense;
        });
    }
}

